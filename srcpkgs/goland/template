# Template file for 'goland'
pkgname=goland
version=2018.2.1
revision=1
depends="giflib"
short_desc="Golang integrated development environment by JetBrains"
maintainer="Marcus Ahnve <m@hnve.org>"
license="Proprietary"
homepage="https://www.jetbrains.org/go/"
distfiles="https://download.jetbrains.com/go/${pkgname}-${version}.tar.gz"
checksum=2a0ad5676215738961f8a4c448459d5370427b23b5f8d593ee6ff6c500d8264d
repository=nonfree
nopie=yes
only_for_archs="i686 x86_64"

post_extract() {
	mv $XBPS_BUILDDIR/GoLand-${version} ${wrksrc}
}

do_install() {
	vmkdir usr/bin
	vmkdir usr/share/doc/${pkgname}
	vmkdir usr/share/${pkgname}

	mv bin lib plugins ${DESTDIR}/usr/share/${pkgname}
	mv build.txt license help ${DESTDIR}/usr/share/doc/${pkgname}
	rm ${DESTDIR}/usr/share/${pkgname}/bin/fsnotifier-arm
	if [ "$XBPS_TARGET_MACHINE" = "x86_64" ]; then
		rm ${DESTDIR}/usr/share/${pkgname}/bin/fsnotifier
		rm ${DESTDIR}/usr/share/${pkgname}/bin/${pkgname}.vmoptions
		rm ${DESTDIR}/usr/share/${pkgname}/lib/libpty/linux/x86/libpty.so
	else
		rm ${DESTDIR}/usr/share/${pkgname}/bin/fsnotifier64
		rm ${DESTDIR}/usr/share/${pkgname}/bin/${pkgname}64.vmoptions
		rm ${DESTDIR}/usr/share/${pkgname}/lib/libpty/linux/x86_64/libpty.so
	fi

	ln -sf /usr/share/${pkgname}/bin/${pkgname}.sh ${DESTDIR}/usr/bin/${pkgname}
}
